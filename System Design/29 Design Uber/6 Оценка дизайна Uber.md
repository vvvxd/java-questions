
# Оценка дизайна Uber

Давайте оценим наш дизайн на соответствие нефункциональным требованиям.


## Выполнение нефункциональных требований

Давайте оценим, как наша система выполняет нефункциональные требования.

### Доступность

Наша система обладает высокой доступностью. Мы использовали WebSocket серверы. Если пользователь отключается, сессия восстанавливается через балансировщик нагрузки с другим сервером. Мы использовали несколько реплик наших баз данных с моделью репликации "основной-вторичный". У нас есть база данных Cassandra, которая обеспечивает высокую доступность и не имеет единой точки отказа. Мы использовали CDN, кэш и балансировщики нагрузки, что повышает доступность нашей системы.

### Масштабируемость

Наша система обладает высокой масштабируемостью. Мы использовали множество независимых сервисов, чтобы мы могли масштабировать их горизонтально, независимо друг от друга в соответствии с нашими потребностями. Мы использовали QuadTrees для поиска, разделяя карту на меньшие сегменты, что сокращает пространство поиска. Мы использовали CDN, что увеличивает способность обслуживать больше пользователей. Мы также использовали NoSQL базу данных, Cassandra, которая является горизонтально масштабируемой. Кроме того, мы использовали балансировщики нагрузки, которые улучшают скорость за счет распределения нагрузки на чтение между различными серверами.

### Надежность

Наша система обладает высокой надежностью. Поездка может продолжаться, даже если соединение пассажира или водителя прервано. Это достигается за счет использования их телефонов в качестве локального хранилища. Использование нескольких WebSocket серверов обеспечивает плавную работу практически в реальном времени. Если какой-либо из серверов выходит из строя, пользователь может переподключиться к другому серверу. Мы также использовали резервные копии серверов и баз данных, чтобы не было единой точки отказа. Наши сервисы разделены и изолированы, что в конечном итоге повышает надежность. Балансировщики нагрузки помогают перенаправлять запросы от вышедших из строя серверов к исправным.

### Согласованность (Consistency)

Мы использовали хранилища, такие как MySQL, для поддержания согласованности наших данных на глобальном уровне. Более того, наша система использует синхронную репликацию для достижения строгой согласованности. Из-за ограниченного числа писателей и читателей данных для одной поездки (пассажир, водитель, некоторые внутренние сервисы) использование традиционных баз данных не становится узким местом. Также в этом сценарии упрощается шардирование данных.

### Обнаружение мошенничества

Наша система способна обнаруживать любую мошенническую деятельность, связанную с платежами. Мы использовали систему RADAR для обнаружения любой подозрительной активности. RADAR распознает начало попытки мошенничества и создает правило для ее предотвращения.

---

**Выполнение нефункциональных требований**

| Требования             | Техники                                                                                                        |
|------------------------|----------------------------------------------------------------------------------------------------------------|
| **Доступность**        | <ul><li>Использование реплик серверов</li><li>Использование реплик баз данных с базой данных Cassandra</li><li>Балансировщики нагрузки скрывают сбои серверов от конечных пользователей</li></ul> |
| **Масштабируемость**   | <ul><li>Горизонтальное шардирование базы данных</li><li>NoSQL база данных Cassandra</li></ul>                  |
| **Надежность**         | <ul><li>Отсутствие единой точки отказа</li><li>Резервирование компонентов</li></ul>                                |
| **Согласованность**    | <ul><li>Строгая согласованность с использованием синхронных репликаций</li></ul>                                 |
| **Обнаружение мошенничества** | <ul><li>Использование RADAR для распознавания и предотвращения любого мошенничества, связанного с платежами</li></ul> |

---

## Заключение

В этой главе мы узнали, как спроектировать сервис вызова такси, подобный Uber. Мы обсудили его функциональные и нефункциональные требования. Мы узнали, как эффективно находить водителей на карте с помощью QuadTrees. Мы также обсудили, как эффективно рассчитывать предполагаемое время прибытия, используя алгоритмы маршрутизации и машинное обучение. Кроме того, мы узнали, что защита нашего сервиса от мошеннических действий важна для успеха бизнеса.
